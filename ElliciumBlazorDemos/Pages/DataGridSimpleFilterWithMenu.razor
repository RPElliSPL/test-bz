
@using ElliciumBlazorDemos.Data
@using ElliciumBlazorDemos.Models.Northwind
@using Microsoft.EntityFrameworkCore

@inherits DbContextPage

<div class="container-fluid my-3">
    <div class="row">
        <div class="col-md-4 col-lg-3">
            <ElliciumText TextStyle="TextStyle.Subtitle1" TagName="TagName.H2">
                Filter case sensitivity
            </ElliciumText>
            <ElliciumDropDown @bind-Value="filterCaseSensitivity" Data="@(Enum.GetValues(typeof(FilterCaseSensitivity)))" Change="@(args => grid.Reload())">
                <Template>
                    @Enum.GetName((FilterCaseSensitivity)context)
                </Template>
            </ElliciumDropDown>
        </div>
        <div class="col-md-8 col-lg-9">
            <ElliciumText TextStyle="TextStyle.Subtitle1" TagName="TagName.H2">
                Filter logical operator
            </ElliciumText>
            <ElliciumDropDown @bind-Value="logicalFilterOperator" Data="@(Enum.GetValues(typeof(LogicalFilterOperator)))" Change="@(args => grid.Reload())">
                <Template>
                    @Enum.GetName((LogicalFilterOperator)context)
                </Template>
            </ElliciumDropDown>
        </div>
    </div>
</div>
<ElliciumDataGrid @ref="grid" AllowFiltering="true" AllowColumnResize="true" 
    FilterMode="FilterMode.SimpleWithMenu" PageSize="5" AllowPaging="true" AllowSorting="true" Data="@orders" TItem="Order" ColumnWidth="300px" 
    FilterCaseSensitivity="@filterCaseSensitivity"
    LogicalFilterOperator="@logicalFilterOperator">
    <Columns>
        <ElliciumDataGridColumn TItem="Order" Property="OrderID" Title="Order ID" />
        <ElliciumDataGridColumn TItem="Order" Property="Customer.CompanyName" Title="Customer" />
        <ElliciumDataGridColumn TItem="Order" Property="Employee.LastName" Title="Employee">
            <Template Context="order">
                <ElliciumImage Path="@order.Employee?.Photo" style="width: 32px; height: 32px; border-radius: 16px; margin-right: 6px;" AlternateText="@(order.Employee?.FirstName + " " + order.Employee?.LastName)" />
                @order.Employee?.FirstName @order.Employee?.LastName
            </Template>
        </ElliciumDataGridColumn>
        <ElliciumDataGridColumn TItem="Order" Property="OrderDate" Title="Order Date" FormatString="{0:d}" />
        <ElliciumDataGridColumn TItem="Order" Property="RequiredDate" Title="Required Date" FormatString="{0:d}" />
        <ElliciumDataGridColumn TItem="Order" Property="ShippedDate" Title="Shipped Date" FormatString="{0:d}" />
        <ElliciumDataGridColumn TItem="Order" Property="ShipName" Title="Ship Name" />
        <ElliciumDataGridColumn TItem="Order" Property="ShipCountry" Title="Ship Country" />
    </Columns>
</ElliciumDataGrid>

@code {
    IEnumerable<Order> orders;
    ElliciumDataGrid<Order> grid;

    FilterCaseSensitivity filterCaseSensitivity = FilterCaseSensitivity.CaseInsensitive;
    LogicalFilterOperator logicalFilterOperator = LogicalFilterOperator.Or;

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();

        orders = dbContext.Orders.Include("Customer").Include("Employee");
    }
}